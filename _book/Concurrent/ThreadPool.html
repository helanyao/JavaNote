
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>ThreadPool Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../Java Data Structure/JavaDataStructure.html" />
    
    
    <link rel="prev" href="ConcurrentHashMap.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../Fundamental/Fundamental.html">
            
                <a href="../Fundamental/Fundamental.html">
            
                    
                    Fundanmental
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../Fundamental/Upcast&Downcast.html">
            
                <a href="../Fundamental/Upcast&Downcast.html">
            
                    
                    Upcast & Downcast
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../Fundamental/EqualsOfString.html">
            
                <a href="../Fundamental/EqualsOfString.html">
            
                    
                    Rewrite Equals() of String
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../Fundamental/String.html">
            
                <a href="../Fundamental/String.html">
            
                    
                    String
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../Fundamental/Class.html">
            
                <a href="../Fundamental/Class.html">
            
                    
                    Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../Fundamental/Serializable.html">
            
                <a href="../Fundamental/Serializable.html">
            
                    
                    Serializable
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../Advanced/Advanced.html">
            
                <a href="../Advanced/Advanced.html">
            
                    
                    Advanced
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../Advanced/ClassLoader.html">
            
                <a href="../Advanced/ClassLoader.html">
            
                    
                    Class Loader
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Concurrent.html">
            
                <a href="Concurrent.html">
            
                    
                    Concurrent
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="AQS.html">
            
                <a href="AQS.html">
            
                    
                    AQS(AbstractQueuedSynchronizer)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="CAS.html">
            
                <a href="CAS.html">
            
                    
                    CAS(Compare and Swap)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="CLH.html">
            
                <a href="CLH.html">
            
                    
                    CLH(Craig, Landin, and Hagersten)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="ReentrantLock.html">
            
                <a href="ReentrantLock.html">
            
                    
                    ReentrantLock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="Synchronized.html">
            
                <a href="Synchronized.html">
            
                    
                    Synchronized
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="ConcurrentHashMap.html">
            
                <a href="ConcurrentHashMap.html">
            
                    
                    ConcurrentHashMap
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.7" data-path="ThreadPool.html">
            
                <a href="ThreadPool.html">
            
                    
                    ThreadPool
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../Java Data Structure/JavaDataStructure.html">
            
                <a href="../Java Data Structure/JavaDataStructure.html">
            
                    
                    Java Data Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../JVM/JVM.html">
            
                <a href="../JVM/JVM.html">
            
                    
                    JVM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../JVM/GarbageCollector.html">
            
                <a href="../JVM/GarbageCollector.html">
            
                    
                    Garbage Collector
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../JVM/MemoryManagement.html">
            
                <a href="../JVM/MemoryManagement.html">
            
                    
                    Memory Management
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >ThreadPool</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="thread-pool">Thread Pool</h1>
<h2 id="1-forkjoinpool">1. ForkJoinPool</h2>
<h3 id="11-&#x4ECB;&#x7ECD;">1.1 &#x4ECB;&#x7ECD;</h3>
<p>&#x3000;&#x3000;JDK1.7&#x5F15;&#x5165;&#xFF1B;&#x5927;&#x4EFB;&#x52A1;&#x5206;&#x5272;&#x6210;&#x5C0F;&#x4EFB;&#x52A1;&#xFF1B;&#x5DE5;&#x4F5C;&#x7A83;&#x53D6;(work-stealing)&#x7B97;&#x6CD5;&#x3002;</p>
<p>&#x3000;&#x3000;&#x4E3A;&#x51CF;&#x5C11;&#x7A83;&#x53D6;&#x4EFB;&#x52A1;&#x7EBF;&#x7A0B;&#x548C;&#x88AB;&#x7A83;&#x53D6;&#x4EFB;&#x52A1;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x7ADE;&#x4E89;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x4F7F;&#x7528;&#x53CC;&#x7AEF;&#x961F;&#x5217;&#xFF0C;&#x88AB;&#x7A83;&#x53D6;&#x4EFB;&#x52A1;&#x7EBF;&#x7A0B;&#x6C38;&#x8FDC;&#x4ECE;&#x53CC;&#x7AEF;&#x961F;&#x5217;&#x7684;&#x5934;&#x90E8;&#x62FF;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#xFF0C;&#x800C;&#x7A83;&#x53D6;&#x4EFB;&#x52A1;&#x7684;&#x7EBF;&#x7A0B;&#x6C38;&#x8FDC;&#x4ECE;&#x53CC;&#x7AEF;&#x961F;&#x5217;&#x7684;&#x5C3E;&#x90E8;&#x62FF;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x3002;</p>
<h3 id="12-&#x5E94;&#x7528;&#x573A;&#x666F;">1.2 &#x5E94;&#x7528;&#x573A;&#x666F;</h3>
<p>&#x3000;&#x3000;&#x505A;&#x62A5;&#x8868;&#x5BFC;&#x51FA;&#x65F6;&#xFF0C;&#x5927;&#x91CF;&#x6570;&#x636E;&#x7684;&#x5BFC;&#x51FA;&#x5904;&#x7406;&#xFF1B;&#x505A;BI&#x65F6;&#xFF0C;&#x5927;&#x91CF;&#x7684;&#x6570;&#x636E;&#x8FC1;&#x79FB;&#x6E05;&#x6D17;&#x4F5C;&#x4E1A;&#x7B49;&#x3002;</p>
<h3 id="13-&#x539F;&#x7406;">1.3 &#x539F;&#x7406;</h3>
<p>&#x3000;&#x3000;ForkJoinPool&#x7531;ForkJoinTask&#x6570;&#x7EC4;&#x548C;ForkJoinWorkerThread&#x6570;&#x7EC4;&#x7EC4;&#x6210;&#xFF0C;ForkJoinTask&#x6570;&#x7EC4;&#x8D1F;&#x8D23;&#x5B58;&#x653E;&#x7A0B;&#x5E8F;&#x63D0;&#x4EA4;&#x7ED9;ForkJoinPool&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x800C;ForkJoinWorkerThread&#x6570;&#x7EC4;&#x8D1F;&#x8D23;&#x6267;&#x884C;&#x8FD9;&#x4E9B;&#x4EFB;&#x52A1;&#x3002;</p>
<p>&#x3000;&#x3000;&#x5F53;&#x8C03;&#x7528;ForkJoinTask&#x7684;<code>fork()</code>&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;ForkJoinWorkerThread&#x7684;<code>pushTask()</code>&#x65B9;&#x6CD5;&#x5F02;&#x6B65;&#x7684;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x7136;&#x540E;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> ForkJoinTask <span class="hljs-title">fork</span><span class="hljs-params">()</span> </span>{         
    ((ForkJoinWorkerThread) Thread.currentThread()).pushTask(<span class="hljs-keyword">this</span>);         
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>; 
}
</code></pre>
<p>&#x3000;&#x3000;<code>pushTask()</code>&#x628A;&#x5F53;&#x524D;&#x4EFB;&#x52A1;&#x5B58;&#x653E;&#x5728;ForkJoinTask &#x6570;&#x7EC4;queue&#x91CC;&#x3002;&#x7136;&#x540E;&#x518D;&#x8C03;&#x7528;ForkJoinPool&#x7684;<code>signalWork()</code>&#x65B9;&#x6CD5;&#x5524;&#x9192;&#x6216;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x6765;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushTask</span><span class="hljs-params">(ForkJoinTask t)</span> </span>{
    ForkJoinTask[] q; <span class="hljs-keyword">int</span> s, m;
    <span class="hljs-keyword">if</span> ((q = queue) != <span class="hljs-keyword">null</span>) {    <span class="hljs-comment">// ignore if queue removed</span>
        <span class="hljs-keyword">long</span> u = (((s = queueTop) &amp; (m = q.length - <span class="hljs-number">1</span>)) &lt;&lt; ASHIFT) + ABASE;
        UNSAFE.putOrderedObject(q, u, t);
        queueTop = s + <span class="hljs-number">1</span>;         <span class="hljs-comment">// or use putOrderedInt</span>
        <span class="hljs-keyword">if</span> ((s -= queueBase) &lt;= <span class="hljs-number">2</span>)
            pool.signalWork();
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s == m)
            growQueue();
    }
}
</code></pre>
<p>&#x3000;&#x3000;<code>join()</code>&#x65B9;&#x6CD5;&#x7684;&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x662F;&#x963B;&#x585E;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5E76;&#x7B49;&#x5F85;&#x83B7;&#x53D6;&#x7ED3;&#x679C;&#x3002; &#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title">join</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">if</span> (doJoin() != NORMAL) 
        <span class="hljs-keyword">return</span> reportResult();
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">return</span> getRawResult();
}

<span class="hljs-function"><span class="hljs-keyword">private</span> V <span class="hljs-title">reportResult</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> s;
    Throwable ex;
    <span class="hljs-keyword">if</span> ((s = status) == CANCELLED)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> CancellationException();
    <span class="hljs-keyword">if</span> (s == EXCEPTIONAL &amp;&amp; (ex = getThrowableExcetpion()) != <span class="hljs-keyword">null</span>)
        UNSAFE.throwException(ex);

    <span class="hljs-keyword">return</span> getRawResult();
}
</code></pre>
<p>&#x3000;&#x3000;&#x9996;&#x5148;&#xFF0C;&#x8C03;&#x7528;&#x4E86;<code>doJoin()</code>&#xFF0C;&#x901A;&#x8FC7;<code>doJoin()</code>&#x5F97;&#x5230;&#x5F53;&#x524D;&#x4EFB;&#x52A1;&#x7684;&#x72B6;&#x6001;&#x6765;&#x5224;&#x65AD;&#x8FD4;&#x56DE;&#x4EC0;&#x4E48;&#x7ED3;&#x679C;&#xFF0C;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#x6709;&#x56DB;&#x79CD;&#xFF1A;&#x5DF2;&#x5B8C;&#x6210;&#xFF08;NORMAL&#xFF09;&#xFF0C;&#x88AB;&#x53D6;&#x6D88;&#xFF08;CANCELLED&#xFF09;&#xFF0C;&#x4FE1;&#x53F7;&#xFF08;SIGNAL&#xFF09;&#x548C;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#xFF08;EXCEPTIONAL&#xFF09;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#x662F;&#x5DF2;&#x5B8C;&#x6210;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x4EFB;&#x52A1;&#x7ED3;&#x679C;&#x3002;</li>
<li>&#x5982;&#x679C;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#x662F;&#x88AB;&#x53D6;&#x6D88;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x629B;&#x51FA;CancellationException&#x3002;</li>
<li>&#x5982;&#x679C;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#x662F;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x629B;&#x51FA;&#x5BF9;&#x5E94;&#x7684;&#x5F02;&#x5E38;&#x3002;</li>
</ul>
<p>&#x3000;&#x3000;<code>doJoin()</code>&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">doJoin</span><span class="hljs-params">()</span> </span>{
    Thread t;
    ForkJoinThread w;
    <span class="hljs-keyword">int</span> s;
    <span class="hljs-keyword">boolean</span> completed;
    <span class="hljs-keyword">if</span> ((t = Thread.currentThread()) <span class="hljs-keyword">instanceof</span> ForkJoinWorkerThread) {
        <span class="hljs-keyword">if</span> ((s = status) &lt; <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span> s;
        <span class="hljs-keyword">if</span> ((w = (ForkJoinWorkerThread)t).unpushTask(<span class="hljs-keyword">this</span>)) {
            <span class="hljs-keyword">try</span> {
                completed = exec();
            } <span class="hljs-keyword">catch</span> (Throwable rex) {
                <span class="hljs-keyword">return</span> setExceptionalCompletion(rex);
            }
            <span class="hljs-keyword">if</span> (completed)
                <span class="hljs-keyword">return</span> setCompletion(NORMAL);
        }
        <span class="hljs-keyword">return</span> w.joinTask(<span class="hljs-keyword">this</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> externalAwaitDone();
    }
}
</code></pre>
<p>&#x3000;&#x3000;&#x5728;<code>doJoin()</code>&#x91CC;&#xFF0C;&#x9996;&#x5148;&#x901A;&#x8FC7;&#x67E5;&#x770B;&#x4EFB;&#x52A1;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x770B;&#x4EFB;&#x52A1;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x6267;&#x884C;&#x5B8C;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x6267;&#x884C;&#x5B8C;&#x4E86;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6267;&#x884C;&#x5B8C;&#xFF0C;&#x5219;&#x4ECE;&#x4EFB;&#x52A1;&#x6570;&#x7EC4;&#x91CC;&#x53D6;&#x51FA;&#x4EFB;&#x52A1;&#x5E76;&#x6267;&#x884C;&#x3002;&#x5982;&#x679C;&#x4EFB;&#x52A1;&#x987A;&#x5229;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x4E86;&#xFF0C;&#x5219;&#x8BBE;&#x7F6E;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#x4E3A;<code>NORMAL</code>&#xFF0C;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#xFF0C;&#x5219;&#x7EAA;&#x5F55;&#x5F02;&#x5E38;&#x5E76;&#x5C06;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#x8BBE;&#x7F6E;&#x4E3A;<code>EXCEPTIONAL</code>&#x3002;</p>
<h3 id="14-forkjoinpool-vs-executorservice">1.4 ForkJoinPool VS ExecutorService</h3>
<p>Fork-join allows you to easily execute divide and conquer jobs, which have to be implemented manualy if you want to execute it in ExecutorService. In practice ExecutorService is usualy used to process many independent requests (aka transaction) concurrently, and fork-join when you want to accelerate one coherent job.</p>
<h3 id="15-recursiveaction-example&#xFF08;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF09;">1.5 RecursiveAction Example&#xFF08;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF09;</h3>
<p>&#x3000;&#x3000;&#x4EFB;&#x52A1;&#x7C7B;<code>PrintTask</code>&#x7EDF;&#x4E00;&#x7528;<code>compute()</code>&#x65B9;&#x6CD5;&#x8D1F;&#x8D23;&#x8BA1;&#x7B97;&#x5B50;&#x4EFB;&#x52A1;&#x6216;&#x8005;&#x8BB2;&#x4EFB;&#x52A1;&#x5206;&#x89E3;&#x6210;&#x5B50;&#x4EFB;&#x52A1;&#xFF1B;&#x5BF9;&#x6BCF;&#x6B21;&#x7684;&#x5206;&#x89E3;&#x5747;&#x8C03;&#x7528;&#x7C7B;&#x4F3C;<code>PrintTask.fork()</code>&#x65B9;&#x6CD5;&#xFF1B;&#x6700;&#x540E;&#x52FF;&#x5FD8;<code>ForkJoinPool.shutdown()</code>.</p>
<pre><code class="lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PrintTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecursiveAction</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> MAX = <span class="hljs-number">20</span>; <span class="hljs-comment">// &#x6BCF;&#x4E2A;&#x5C0F;&#x4EFB;&#x52A1;&#x6700;&#x591A;&#x53EA;&#x6253;&#x5370;20&#x4E2A;&#x6570;</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> start, end;

    PrintTask(<span class="hljs-keyword">int</span> s, <span class="hljs-keyword">int</span> e) {
        start = s; end = e;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">compute</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// &#x5F53;end - task&#x503C;&#x5C0F;&#x4E8E;MAX&#x65F6;&#xFF0C;&#x5F00;&#x59CB;&#x6253;&#x5370;</span>
        <span class="hljs-keyword">if</span> ((end - start) &lt; MAX) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt; end; i++) {
                System.out.println(Thread.currentThread().getName() + i);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// &#x5C06;&#x5927;&#x4EFB;&#x52A1;&#x5206;&#x89E3;&#x6210;&#x4E24;&#x4E2A;&#x5C0F;&#x4EFB;&#x52A1;</span>
            <span class="hljs-keyword">int</span> middle = (start + end) / <span class="hljs-number">2</span>;
            PrintTask left = <span class="hljs-keyword">new</span> PrintTask(start, middle);
            PrintTask right = <span class="hljs-keyword">new</span> PrintTask(middle, end);
            <span class="hljs-comment">// &#x5E76;&#x53D1;&#x6267;&#x884C;&#x4E24;&#x4E2A;&#x5C0F;&#x4EFB;&#x52A1;</span>
            left.fork();
            right.fork();
        }
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ForkJoinPoolTest1</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x521B;&#x5EFA;&#x5305;&#x542B;Runtime.getRuntime().availableProcessors()&#x8FD4;&#x56DE;&#x503C;&#x4F5C;&#x4E3A;&#x4E2A;&#x6570;&#x7684;&#x5E76;&#x884C;&#x7EBF;&#x7A0B;&#x6C60;</span>
        ForkJoinPool fjp = <span class="hljs-keyword">new</span> ForkJoinPool();
        <span class="hljs-comment">// &#x63D0;&#x4EA4;&#x53EF;&#x5206;&#x89E3;&#x7684;PrintTask&#x4EFB;&#x52A1;</span>
        fjp.submit(<span class="hljs-keyword">new</span> PrintTask(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>));
        fjp.awaitTermination(<span class="hljs-number">2</span>, TimeUnit.SECONDS); <span class="hljs-comment">// &#x963B;&#x585E;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x76F4;&#x5230;ForkJoinPool&#x4E2D;&#x4EFB;&#x52A1;&#x90FD;&#x6267;&#x884C;&#x5B8C;&#x6BD5;</span>
        fjp.shutdown();
    }
}
</code></pre>
<p>&#x3000;&#x3000;&#x8BA1;&#x7B97;&#x673A;&#x5171;4&#x6838;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6709;4&#x4E2A;worker&#xFF1A;</p>
<p><img src="Images/forkjoinpool_worker.png" alt="Result"></p>
<h3 id="16-recursivetask-example&#xFF08;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF09;">1.6 RecursiveTask Example&#xFF08;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF09;</h3>
<pre><code class="lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SumTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecursiveTask</span>&lt;<span class="hljs-title">Integer</span>&gt; </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> MAX = <span class="hljs-number">70</span>; <span class="hljs-comment">// &#x6BCF;&#x4E2A;&#x5C0F;&#x4EFB;&#x52A1;&#x6700;&#x591A;&#x53EA;&#x6253;&#x5370;70&#x4E2A;&#x6570;</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> arr[], start, end;

    SumTask(<span class="hljs-keyword">int</span>[] a, <span class="hljs-keyword">int</span> s, <span class="hljs-keyword">int</span> e) {
        arr = a; start = s; end = e;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> Integer <span class="hljs-title">compute</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// &#x5F53;end - task&#x503C;&#x5C0F;&#x4E8E;MAX&#x65F6;&#xFF0C;&#x5F00;&#x59CB;&#x6253;&#x5370;</span>
        <span class="hljs-keyword">if</span> ((end - start) &lt; MAX) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt; end; i++) {
                sum += arr[i];
            }

            <span class="hljs-keyword">return</span> sum;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// &#x5C06;&#x5927;&#x4EFB;&#x52A1;&#x5206;&#x89E3;&#x6210;&#x4E24;&#x4E2A;&#x5C0F;&#x4EFB;&#x52A1;</span>
            <span class="hljs-keyword">int</span> middle = (start + end) / <span class="hljs-number">2</span>;
            SumTask left = <span class="hljs-keyword">new</span> SumTask(arr, start, middle);
            SumTask right = <span class="hljs-keyword">new</span> SumTask(arr, middle, end);
            <span class="hljs-comment">// &#x5E76;&#x53D1;&#x6267;&#x884C;&#x4E24;&#x4E2A;&#x5C0F;&#x4EFB;&#x52A1;</span>
            left.fork();
            right.fork();

            <span class="hljs-keyword">return</span> left.join() + right.join();
        }
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ForkJoinPoolTest2</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-keyword">int</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1000</span>];
        Random ran = <span class="hljs-keyword">new</span> Random();
        <span class="hljs-keyword">int</span> total = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) {
            <span class="hljs-keyword">int</span> temp = ran.nextInt(<span class="hljs-number">100</span>);
            total += (arr[i] = temp); <span class="hljs-comment">// &#x8BA1;&#x7B97;&#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x603B;&#x548C;</span>
        }
        <span class="hljs-comment">// &#x521B;&#x5EFA;&#x5305;&#x542B;Runtime.getRuntime().availableProcessors()&#x8FD4;&#x56DE;&#x503C;&#x4F5C;&#x4E3A;&#x4E2A;&#x6570;&#x7684;&#x5E76;&#x884C;&#x7EBF;&#x7A0B;&#x6C60;</span>
        ForkJoinPool fjp = <span class="hljs-keyword">new</span> ForkJoinPool();
        <span class="hljs-comment">// &#x63D0;&#x4EA4;&#x53EF;&#x5206;&#x89E3;&#x7684;SumTask&#x4EFB;&#x52A1;</span>
        Future&lt;Integer&gt; future = fjp.submit(<span class="hljs-keyword">new</span> SumTask(arr, <span class="hljs-number">0</span>, arr.length));
        System.out.println(<span class="hljs-string">&quot;Result = &quot;</span> + future.get());
        fjp.shutdown();
    }
}
</code></pre>
<h2 id="2-executorservice&#x7EBF;&#x7A0B;&#x6C60;">2. ExecutorService&#x7EBF;&#x7A0B;&#x6C60;</h2>
<h3 id="21-&#x5EFA;&#x7ACB;&#x591A;&#x7EBF;&#x7A0B;&#x6B65;&#x9AA4;">2.1 &#x5EFA;&#x7ACB;&#x591A;&#x7EBF;&#x7A0B;&#x6B65;&#x9AA4;</h3>
<p><img src="Images/create_executorservice.png" alt="Create ExecutorService"></p>
<h3 id="22-&#x56DB;&#x79CD;&#x7EBF;&#x7A0B;&#x6C60;">2.2 &#x56DB;&#x79CD;&#x7EBF;&#x7A0B;&#x6C60;</h3>
<p><img src="Images/kinds_of_executorservice.png" alt="Four Kinds of ExecutorService"></p>
<h3 id="23-&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x5EFA;&#x7ACB;&#x7EBF;&#x7A0B;&#x6C60;">2.3 &#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x5EFA;&#x7ACB;&#x7EBF;&#x7A0B;&#x6C60;</h3>
<p>&#x3000;&#x3000;&#x4E0A;&#x9762;&#x56DB;&#x79CD;&#x7EBF;&#x7A0B;&#x6C60;&#x90FD;&#x4F7F;&#x7528;Executor&#x7684;&#x7F3A;&#x7701;&#x7EBF;&#x7A0B;&#x5DE5;&#x5382;&#x5EFA;&#x7ACB;&#x7EBF;&#x7A0B;&#xFF0C;&#x4E5F;&#x53EF;&#x5355;&#x72EC;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684;&#x7EBF;&#x7A0B;&#x5DE5;&#x5382;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x7F3A;&#x7701;&#x7EBF;&#x7A0B;&#x5DE5;&#x5382;&#x4EE3;&#x7801;:</p>
<pre><code class="lang-java"><span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DefaultThreadFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ThreadFactory</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> AtomicInteger poolNumber = <span class="hljs-keyword">new</span> AtomicInteger(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">final</span> ThreadGroup group;
    <span class="hljs-keyword">final</span> AtomicInteger threadNumber = <span class="hljs-keyword">new</span> AtomicInteger(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">final</span> String namePrefix;

    DefaultThreadFactory() {
        SecurityManager s = System.getSecurityManager();
        group = (s != <span class="hljs-keyword">null</span>) ? s.getThreadGroup() : Thread.currentThread().getThreadGroup();
        namePrefix = <span class="hljs-string">&quot;pool-&quot;</span> + poolNumber.getAndIncrement() + <span class="hljs-string">&quot;-thread- &quot;</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> Thread <span class="hljs-title">newThread</span><span class="hljs-params">(Runnable r)</span> </span>{
        Thread t = <span class="hljs-keyword">new</span> Thread(group, r, namePrefix + threadNumber.getAndIncrement(), <span class="hljs-number">0</span>);
        <span class="hljs-keyword">if</span> (t.isDaemon())
            t.setDaemon(<span class="hljs-keyword">false</span>);
        <span class="hljs-keyword">if</span> (t.getPriority() != Thread.NORM_PRIORITY)
            t.setPriority(Thread.NORM_PRIORITY);

        <span class="hljs-keyword">return</span> t;
    }
}
</code></pre>
<h3 id="24-&#x628A;runnable&#x5B9E;&#x4F8B;&#x52A0;&#x5165;pool">2.4 &#x628A;Runnable&#x5B9E;&#x4F8B;&#x52A0;&#x5165;pool</h3>
<p>&#x3000;&#x3000;<code>Executor&#x7684;execute()</code>&#x5C06;Runnable&#x5B9E;&#x4F8B;&#x52A0;&#x5165;pool&#x4E2D;,&#x5E76;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;pool size&#x8BA1;&#x7B97;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x5904;&#x7406;&#x3002;<code>execute()</code>&#x5728;Executor&#x63A5;&#x53E3;&#x4E2D;&#x5B9A;&#x4E49;,&#x6709;&#x591A;&#x4E2A;&#x5B9E;&#x73B0;&#x7C7B;&#x90FD;&#x5B9A;&#x4E49;&#x4E86;&#x4E0D;&#x540C;&#x7684;<code>execute()</code>&#x65B9;&#x6CD5;&#x3002;&#x5982;<code>ThreadPoolExecutor</code>&#x7C7B;&#xFF08;cache,fiexed,single&#x4E09;&#x79CD;&#x6C60;&#x5B50;&#x90FD;&#x662F;&#x8C03;&#x7528;&#x5B83;&#xFF09;&#x7684;<code>execute()</code>&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">(Runnable command)</span> </span>{
    <span class="hljs-keyword">if</span> (command == <span class="hljs-keyword">null</span>)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();
    <span class="hljs-keyword">if</span> (poolSize &gt;= corePoolSize || !addIfUnderCorePoolSize(command)) {
        <span class="hljs-keyword">if</span> (runState == RUNNING &amp;&amp; workQueue.offer(command)) {
            <span class="hljs-keyword">if</span> (runStat != RUNNING || poolSize == <span class="hljs-number">0</span>)
                ensureQueuedTaskHandled(command);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!addIfUnderMaximumPoolSize(command)) {
            reject(command); <span class="hljs-comment">// is shutdown or saturated</span>
        }
    }
}
</code></pre>
<p>&#x3000;&#x3000;ThreadPoolExecutor&#x6709;&#x4E24;&#x4E2A;&#x6700;&#x91CD;&#x8981;&#x7684;&#x96C6;&#x5408;&#x5C5E;&#x6027;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x5B58;&#x50A8;&#x63A5;&#x6536;&#x4EFB;&#x52A1;&#x7684;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x548C;&#x7528;&#x6765;&#x5E72;&#x6D3B;&#x7684;&#x4F5C;&#x4E1A;&#x96C6;&#x5408;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-comment">// task queue</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> BlockingQueue&lt;Runnable&gt; workQueue;
<span class="hljs-comment">// worker thread set</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> HashSet&lt;Worker&gt; workers = <span class="hljs-keyword">new</span> HashSet&lt;Worker&gt;();
</code></pre>
<p>&#x3000;&#x3000;&#x5176;&#x4E2D;&#x963B;&#x585E;&#x961F;&#x5217;<code>workQueue</code>&#x5B58;&#x50A8;&#x5F85;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x5728;&#x6784;&#x9020;&#x7EBF;&#x7A0B;&#x6C60;&#x65F6;&#x53EF;&#x9009;&#x62E9;&#x6EE1;&#x8DB3;BlockingQueue&#x5B9A;&#x4E49;&#x7684;SynchronousQueue&#x3001;LinkedBlockingQueue&#x6216;DelayedWorkQueue&#x7B49;&#x4E0D;&#x540C;&#x963B;&#x585E;&#x961F;&#x5217;&#x6765;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7279;&#x5F81;&#x7684;&#x7EBF;&#x7A0B;&#x6C60;&#x3002;</p>
<h2 id="25-&#x6267;&#x884C;&#x4EFB;&#x52A1;">2.5 &#x6267;&#x884C;&#x4EFB;&#x52A1;</h2>
<p>&#x3000;&#x3000;<code>Worker</code>&#x8D1F;&#x8D23;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF1A; <code>private final class Worker implements Runnable</code></p>
<p>&#x3000;&#x3000;&#x5728;<code>run()</code>&#x4E2D;&#x4F5C;&#x4E1A;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;<code>getTask()</code>&#x83B7;&#x53D6;&#x4EFB;&#x52A1;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;<code>runTask(task)</code>&#x6267;&#x884C;&#x4EFB;&#x52A1;:</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">try</span> {
        Runnable task = firstTask;
        <span class="hljs-comment">// &#x5FAA;&#x73AF;&#x4ECE;&#x7EBF;&#x7A0B;&#x6C60;&#x7684;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x83B7;&#x53D6;&#x4EFB;&#x52A1;</span>
        <span class="hljs-keyword">while</span> (task != <span class="hljs-keyword">null</span> || (task = getTask()) != <span class="hljs-keyword">null</span>) {
            runTask(task); <span class="hljs-comment">// &#x6267;&#x884C;&#x4EFB;&#x52A1;</span>
            task = <span class="hljs-keyword">null</span>;
        }
    } <span class="hljs-keyword">finally</span> {
        workerDone(<span class="hljs-keyword">this</span>);
    }
}
</code></pre>
<p>&#x3000;&#x3000;<code>getTask()</code>&#x662F;ThreadPoolExecutor&#x63D0;&#x4F9B;&#x7ED9;&#x5176;&#x5185;&#x90E8;&#x7C7B;<code>Worker</code>&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x4F5C;&#x7528;&#x662F;&#x4ECE;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x4E2D;&#x53D6;&#x4EFB;&#x52A1;&#xFF0C;&#x6E90;&#x6E90;&#x4E0D;&#x65AD;&#x5730;&#x8F93;&#x51FA;&#x4EFB;&#x52A1;:</p>
<pre><code class="lang-java"><span class="hljs-function">Runnable <span class="hljs-title">getTask</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">for</span> (;;) {
        r = workQueue.take(); <span class="hljs-comment">// &#x4ECE;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x5934;&#x90E8;&#x53D6;&#x4EFB;&#x52A1;</span>
        <span class="hljs-keyword">return</span> r;
    }
}
</code></pre>
<p>&#x3000;&#x3000;<code>runTask(Runnable task)</code>&#x662F;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;<code>Worker</code>&#x771F;&#x6B63;&#x5904;&#x7406;&#x6BCF;&#x4E2A;&#x5177;&#x4F53;&#x4EFB;&#x52A1;:</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">runTask</span><span class="hljs-params">(Runnable task)</span> </span>{
    <span class="hljs-comment">// &#x8C03;&#x7528;&#x4EFB;&#x52A1;&#x7684;run&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x5728;Worker&#x7EBF;&#x7A0B;&#x4E2D;&#x6267;&#x884C;Task&#x5185;&#x5B9A;&#x4E49;&#x7684;&#x5185;&#x5BB9;</span>
    task.run();
}
</code></pre>
<p>&#x3000;&#x3000;&#x5176;&#x4E2D;&#x7684;<code>task.run()</code>&#x5B9E;&#x9645;&#x662F;<code>FutureTask</code>&#x7684;<code>run()</code>&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x4E3A;<code>FutureTask</code>&#x5B9E;&#x73B0;&#x4E86;<code>Runnable</code>&#x63A5;&#x53E3;&#x3002;<code>FutureTask</code>&#x4E3B;&#x8981;&#x59D4;&#x6258;&#x5185;&#x90E8;&#x5B9A;&#x4E49;&#x7684;<code>Sync</code>&#x7C7B;&#xFF0C;<code>Sync</code>&#x7EE7;&#x627F;&#x81EA;AQS&#xFF0C;&#x7EF4;&#x62A4;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#x3002;</p>
<h2 id="26-&#x83B7;&#x53D6;&#x7ED3;&#x679C;">2.6 &#x83B7;&#x53D6;&#x7ED3;&#x679C;</h2>
<p>&#x3000;&#x3000;&#x83B7;&#x53D6;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x53EA;&#x9700;&#x8C03;&#x7528;<code>FutureTask</code>&#x7684;<code>get()</code>&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;&#x8BE5;&#x65B9;&#x6CD5;&#x662F;&#x5728;Future&#x63A5;&#x53E3;&#x4E2D;&#x5C31;&#x5B9A;&#x4E49;&#x7684;&#x3002;</p>
<h2 id="27-&#x603B;&#x7ED3;">2.7 &#x603B;&#x7ED3;</h2>
<p><img src="Images/executorservice_workflow.png" alt="Overall of ExecutorService"></p>
<ol>
<li>&#x9996;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x670D;&#x52A1;<code>ExecutorService</code>&#xFF0C;&#x4F7F;&#x7528;&#x5DE5;&#x5177;&#x7C7B;<code>Executors</code>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x4E0D;&#x540C;&#x7684;&#x7EBF;&#x7A0B;&#x6C60;<code>ThreadPoolExecutor</code>&#xFF1B;</li>
<li>&#x7EBF;&#x7A0B;&#x6C60;&#x662F;&#x4E13;&#x95E8;&#x8D1F;&#x8D23;&#x628A;&#x4EFB;&#x52A1;&#x5C01;&#x88C5;&#x6210;<code>FutureTask</code>&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x8F93;&#x5165;&#x5B9A;&#x4E49;&#x597D;&#x8981;&#x83B7;&#x5F97;&#x7ED3;&#x679C;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;<code>submit()</code>&#x4EFB;&#x52A1;&#x4E86;&#x3002;</li>
<li>&#x7EBF;&#x7A0B;&#x6C60;&#x63A5;&#x6536;&#x8F93;&#x5165;&#x7684;task&#xFF0C;&#x6839;&#x636E;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#xFF0C;&#x542F;&#x52A8;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x6765;&#x6267;&#x884C;task&#x3002;</li>
<li>&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x5728;&#x5176;<code>run()</code>&#x65B9;&#x6CD5;&#x4E2D;&#x4E00;&#x76F4;&#x5FAA;&#x73AF;&#xFF0C;&#x4ECE;&#x7EBF;&#x7A0B;&#x6C60;&#x9886;&#x53D6;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x7684;task&#xFF0C;&#x8C03;&#x7528;task&#x7684;<code>run()</code>&#x65B9;&#x6CD5;&#x6267;&#x884C;task&#x7684;&#x4EFB;&#x52A1;&#x3002;</li>
<li><code>FutureTask</code>&#x7684;<code>run()</code>&#x65B9;&#x6CD5;&#x4E2D;&#x8C03;&#x7528;&#x5185;&#x90E8;&#x7C7B;<code>Sync</code>&#x7684;<code>innerRun()</code>&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x5177;&#x4F53;&#x4EFB;&#x52A1;&#xFF0C;&#x5E76;&#x628A;&#x4EFB;&#x52A1;&#x7684;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x7ED9;<code>FutureTask</code>&#x7684;<code>result</code>&#x53D8;&#x91CF;&#x3002;</li>
<li>&#x5F53;&#x63D0;&#x53CA;&#x4EFB;&#x52A1;&#x7684;&#x89D2;&#x8272;&#x8C03;&#x7528;<code>FutureTask</code>&#x7684;<code>get()</code>&#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x65F6;&#xFF0C;<code>Sync</code>&#x7684;<code>innerGet()</code>&#x65B9;&#x6CD5;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x6839;&#x636E;&#x4EFB;&#x52A1;&#x7684;&#x6267;&#x884C;&#x72B6;&#x6001;&#x5224;&#x65AD;&#xFF0C;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x5219;&#x8FD4;&#x56DE;&#x6267;&#x884C;&#x7ED3;&#x679C;&#xFF1B;&#x672A;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x5219;&#x7B49;&#x5F85;&#x3002;</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="ConcurrentHashMap.html" class="navigation navigation-prev " aria-label="Previous page: ConcurrentHashMap">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../Java Data Structure/JavaDataStructure.html" class="navigation navigation-next " aria-label="Next page: Java Data Structure">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"ThreadPool","level":"1.4.7","depth":2,"next":{"title":"Java Data Structure","level":"1.5","depth":1,"path":"Java Data Structure/JavaDataStructure.md","ref":"Java Data Structure/JavaDataStructure.md","articles":[]},"previous":{"title":"ConcurrentHashMap","level":"1.4.6","depth":2,"path":"Concurrent/ConcurrentHashMap.md","ref":"Concurrent/ConcurrentHashMap.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Concurrent/ThreadPool.md","mtime":"2016-11-12T14:53:10.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2016-12-03T11:01:22.920Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

